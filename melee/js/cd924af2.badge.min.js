var utils=function(a,b){"use strict";var c=function(b,c){var d=a.createElement("script");d.src=b+"badge."+c,d.type="text/javascript",a.getElementsByTagName("body")[0].appendChild(d)},d=function(){for(var a={},c=b.location.search.substring(1),d=c.split("&"),e=0;e<d.length;e++){var f=d[e].split("=");if("undefined"==typeof a[f[0]])a[f[0]]=f[1];else if("string"==typeof a[f[0]]){var g=[a[f[0]],f[1]];a[f[0]]=g}else a[f[0]].push(f[1])}return a};return{requestJSONP:c,queryString:d}}(document,window),badge=function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p;switch(-1!==b.location.href.indexOf("twitch")&&(c="twitch"),-1!==b.location.href.indexOf("justin")&&(c="justin"),-1!==b.location.href.indexOf("ustream")&&(c="ustream"),-1!==b.location.href.indexOf("hitbox")&&(c="hitbox"),-1!==b.location.href.indexOf("livestream")&&(c="livestream"),e=utils.queryString().username,f=utils.queryString().bg?'style="background:#'+utils.queryString().bg+'"':"",g=utils.queryString().link?'style="color:#'+utils.queryString().link+'"':"",h=utils.queryString().text?'style="color:#'+utils.queryString().text+'"':"",j=a.querySelector("[data-js=badge]"),k="/images/"+c+"-no-image.png",c){case"twitch":d="5j0r5b7qb7kro03fvka3o8kbq262wwm",i=utils.queryString().theme?utils.queryString().theme:"light",o="https://api.twitch.tv/kraken/streams/"+e+"?client_id="+d+"&callback=",p="https://api.twitch.tv/kraken/channels/"+e+"?client_id="+d+"&callback=";break;case"justin":o="http://api.justin.tv/api/stream/list.json?channel="+e+"&jsonp=",p="http://api.justin.tv/api/channel/show/"+e+".json?jsonp=";break;case"ustream":d="EE028473488E26E1424E67B209A3C423",o="http://api.ustream.tv/json/channel/live/search/username:eq:"+e+"?key="+d+"&callback=",p="http://api.ustream.tv/json/user/"+e+"/getInfo?key="+d+"&callback=";break;case"hitbox":o="http://api.hitbox.tv/media/live/"+e+"&jsonp=",p="http://api.justin.tv/api/channel/show/"+e+".json?jsonp=";break;case"livestream":o="http://api.new.livestream.com/accounts/"+e+"/?callback=",p="http://api.new.livestream.com/accounts/"+e+"/?callback="}var q=function(){a.body.style.backgroundColor=utils.queryString().bg?"#"+utils.queryString().bg:"","undefined"==typeof c||""===c?j.innerHTML='<div class="badge badge--'+c+" "+i+'" '+f+"><ul><li "+h+">Please select a service</li></ul></div>":"undefined"==typeof e||""===e?j.innerHTML='<div class="badge badge--'+c+" "+i+'" '+f+"><ul><li "+h+">Please select a username</li></ul></div>":utils.requestJSONP(o,"drawStream")},r=function(a){switch(c){case"twitch":l="http://twitch.tv/"+e,a.stream?(e=decodeURIComponent(a.stream.channel.display_name),k=a.stream.channel.logo,m=" playing "+(a.stream.game?'<a href="http://www.twitch.tv/directory/game/'+encodeURIComponent(a.stream.game)+'" target="_blank" '+g+">"+a.stream.game+"</a>":""),n=a.stream.viewers):utils.requestJSONP(p,"drawChannel");break;case"justin":l="http://justin.tv/"+e,a[0]?(k=a[0].channel.image_url_small,m=a[0].title,n=a[0].channel_count):utils.requestJSONP(p,"drawChannel");break;case"ustream":l="http://ustream.tv/"+e,null!==a?(k=a[0].imageUrl.small,m=a[0].title,n=a[0].viewersNow):utils.requestJSONP(p,"drawChannel");break;case"hitbox":l="http://hitbox.tv/"+e,null!==a?(k=a[1].channel.user_logo_small,m=a[1].category_name,n=a[1].category_viewers):utils.requestJSONP(p,"drawChannel");break;case"livestream":l="http://new.livestream.com/"+e+"/",a.upcoming_events.data[0].in_progress?(k=a.picture.thumb_url,m=a.upcoming_events.data[0].description,n=a.upcoming_events.data[0].viewer_count):utils.requestJSONP(p,"drawChannel")}j.innerHTML='<div class="badge badge--'+c+" "+i+'" '+f+'><ul class="badge__list"><li class="badge__user-name"><a href="'+l+'" target="_blank" '+g+'><img src="'+k+'" width="44" height="44" alt="'+e+'" channel logo" class="badge__icon">'+e+'</a></li><li class="badge__live" '+h+'><b>LIVE</b> <span class="badge__online"></span> '+m+'</li><li class="badge__viewers" '+h+'><span aria-hidden="true" class="badge__icon-eye"></span><span class="badge__viewer-number">'+n+"</span></li></ul></div>"},s=function(a){switch(c){case"twitch":l="http://twitch.tv/"+e,e=a.display_name,a.logo&&(k=a.logo);break;case"justin":l="http://justin.tv/"+e,a.image_url_small&&(k=a.image_url_small);break;case"ustream":l="http://ustream.tv/"+e,null!==a&&(k=a.imageUrl.small);break;case"livestream":l="http://new.livestream.com/"+e+"/",null!==a&&(k=a.picture.thumb_url)}j.innerHTML='<div class="badge badge--'+c+" "+i+'" '+f+'><ul class="badge__list"><li><a href="'+l+'" class="badge__user-name" target="_blank" '+g+'><img src="'+k+'" width="44" height="44" alt="'+e+' channel logo" class="badge__icon">'+e+'</a></li><li class="badge__live" '+h+"><b>Offline</b></li></ul></div>"};return{init:q,drawStream:r,drawChannel:s}}(document,window);badge.init();